# target/release/iroha_swarm -p 1 -s xyzzy -c ./configs/swarm -i hyperledger/iroha:local -b . -o ./configs/swarm/docker-compose.single.yml -HF
# 
# This configuration has been generated by `iroha_swarm` using the above settings.
# You should not edit this manually.

services:
  image_provider:
    image: hyperledger/iroha:local
    build: ../..
    pull_policy: never
    command: echo ok
  irohad0:
    depends_on:
    - image_provider
    image: hyperledger/iroha:local
    pull_policy: never
    environment:
      CHAIN: 00000000-0000-0000-0000-000000000000
      PUBLIC_KEY: ed012018CC218A5830112811C85287E43CEE37A81CBACEA72CFAB6A855E4A89BD60A91
      PRIVATE_KEY: 802640268A94EC4A0FD1BEEC8ABD0A6CC184BCC5090698ADFF08758016D509F75FB6EC18CC218A5830112811C85287E43CEE37A81CBACEA72CFAB6A855E4A89BD60A91
      P2P_ADDRESS: 0.0.0.0:1337
      API_ADDRESS: 0.0.0.0:8080
      GENESIS_PUBLIC_KEY: ed0120AC9417E94E01FC2C3120AC6D6CE51C1567FE80BFBDA7A11A431D8D81E88A50C8
      GENESIS_SIGNED_FILE: /tmp/genesis.signed.scale
    ports:
    - 1337:1337
    - 8080:8080
    volumes:
    - ./:/config
    init: true
    healthcheck:
      test: test $(curl -s http://127.0.0.1:8080/status/blocks) -gt 0
      interval: 2s
      timeout: 1s
      retries: 30
      start_period: 4s
    command: |-
      /bin/sh -c "
        kagami genesis sign /config/genesis.json \
          --public-key ed012018CC218A5830112811C85287E43CEE37A81CBACEA72CFAB6A855E4A89BD60A91 \
          --private-key 802640268A94EC4A0FD1BEEC8ABD0A6CC184BCC5090698ADFF08758016D509F75FB6EC18CC218A5830112811C85287E43CEE37A81CBACEA72CFAB6A855E4A89BD60A91 \
          --out-file /tmp/genesis.signed.scale && \
        irohad --submit-genesis
      "
